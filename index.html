<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Notification Demo</title>

<style>
  :root {
    --bg:#f4f6f8; --card:#fff; --text:#000; --panel:#eef2ff;
    --green:#22c55e; --yellow:#eab308; --red:#ef4444;
  }
  body.dark {
    --bg:#0f172a; --card:#1e293b; --text:#e5e7eb; --panel:#020617;
  }
  body {
    margin:0; padding:20px; font-family:Arial,sans-serif;
    background:var(--bg); color:var(--text);
  }
  .main {
    max-width:520px; margin:auto; background:var(--card);
    padding:20px; border-radius:10px;
    box-shadow:0 10px 25px rgba(0,0,0,.15);
  }
  button {
    width:100%; padding:10px; margin-top:10px;
    border:none; border-radius:6px; cursor:pointer;
    font-size:15px;
  }
  .primary{background:#4f46e5;color:#fff}
  .normal{background:#10b981;color:#fff}
  .danger{background:#ef4444;color:#fff}
  .stop{background:#6b7280;color:#fff}
  .panelBtn{background:#0ea5e9;color:#fff}

  .row {margin-top:10px;font-size:14px}
  .badge {
    padding:3px 8px; border-radius:999px; font-size:12px;
    color:#fff; margin-left:6px;
  }
  .green{background:var(--green)}
  .yellow{background:var(--yellow)}
  .red{background:var(--red)}

  .progress {
    width:100%; height:14px; background:#374151;
    border-radius:7px; overflow:hidden; margin-top:10px;
  }
  .bar {height:100%; width:0%; background:#ef4444}

  .log {
    margin-top:10px; padding:10px; background:var(--panel);
    border-radius:6px; height:120px; overflow-y:auto;
    font-size:13px;
  }

  /* SIDE PANEL */
  .side {
    position:fixed; top:0; right:-320px;
    width:320px; height:100%; background:var(--card);
    padding:20px; box-shadow:-10px 0 25px rgba(0,0,0,.25);
    transition:right .3s ease; z-index:1000;
  }
  .side.open { right:0 }
  .history {
    margin-top:10px; padding:10px; background:var(--panel);
    border-radius:6px; height:200px; overflow-y:auto;
    font-size:13px;
  }
</style>
</head>

<body>

<div class="main">
  <h2>üîî Notification Experiment</h2>

  <button class="panelBtn" onclick="togglePanel()">‚öôÔ∏è Open Panel</button>

  <button class="primary" onclick="requestPermission()">Allow Notifications</button>
  <button class="normal" onclick="normalNotification()">Normal Notification</button>

  <div class="row">
    Notifications to send:
    <strong><span id="countLabel">30</span></strong>
  </div>
  <input type="range" min="5" max="100" value="30" id="slider" oninput="updateCount()">

  <button class="danger" onclick="fakeHacked()">‚ö†Ô∏è Fake ‚ÄúHacked‚Äù Demo</button>
  <button class="stop" onclick="stopAll()">üõë Stop</button>

  <div class="progress"><div class="bar" id="bar"></div></div>

  <div class="row">
    Status:
    <strong id="statusText">Idle</strong>
  </div>

  <div class="row">
    Attempts: <strong id="attempts">0</strong> |
    Sent: <strong id="sent">0</strong> |
    Blocked: <strong id="blocked">0</strong>
  </div>

  <div class="row">
    Browser protection:
    <span class="badge yellow" id="protection">Unknown</span>
  </div>

  <div class="log" id="log">Ready.</div>
</div>

<!-- SIDE PANEL -->
<div class="side" id="panel">
  <h3>‚öôÔ∏è Controls</h3>
  <button class="panelBtn" onclick="toggleDark()">üåô Toggle Dark Mode</button>
  <button class="panelBtn" onclick="togglePanel()">‚ùå Close</button>

  <h3 style="margin-top:20px;">üïò Fake Notification History</h3>
  <div class="history" id="history">No notifications yet.</div>
</div>

<script>
  const panel = document.getElementById("panel");
  const bar = document.getElementById("bar");
  const slider = document.getElementById("slider");
  const label = document.getElementById("countLabel");
  const logBox = document.getElementById("log");
  const historyBox = document.getElementById("history");

  const statusText = document.getElementById("statusText");
  const attemptsEl = document.getElementById("attempts");
  const sentEl = document.getElementById("sent");
  const blockedEl = document.getElementById("blocked");
  const protectionEl = document.getElementById("protection");

  let total = 30, done = 0;
  let attempts = 0, sent = 0;
  const timeouts = [];

  const messages = [
    "Suspicious login detected",
    "Password attempt blocked",
    "Login from unknown location",
    "Multiple failed logins",
    "New device connected",
    "Immediate action required"
  ];

  function togglePanel(){ panel.classList.toggle("open"); }
  function toggleDark(){ document.body.classList.toggle("dark"); }

  function updateCount(){
    total = Number(slider.value);
    label.textContent = total;
  }

  function log(msg){
    logBox.innerHTML += "<br>" + msg;
    logBox.scrollTop = logBox.scrollHeight;
  }

  function addHistory(msg){
    if (historyBox.textContent.includes("No notifications")) {
      historyBox.innerHTML = "";
    }
    historyBox.innerHTML += "‚Ä¢ " + msg + "<br>";
    historyBox.scrollTop = historyBox.scrollHeight;
  }

  function updateCounters(){
    attemptsEl.textContent = attempts;
    sentEl.textContent = sent;
    blockedEl.textContent = attempts - sent;
  }

  function updateProtection(){
    if (Notification.permission === "denied") {
      protectionEl.textContent = "Blocked";
      protectionEl.className = "badge red";
    } else if (attempts - sent > 3) {
      protectionEl.textContent = "Limited";
      protectionEl.className = "badge yellow";
    } else {
      protectionEl.textContent = "Allowed";
      protectionEl.className = "badge green";
    }
  }

  function requestPermission(){
    Notification.requestPermission().then(p=>{
      log("Permission: " + p);
      updateProtection();
    });
  }

  function normalNotification(){
    if (Notification.permission !== "granted") return;
    attempts++;
    try {
      new Notification("School Demo",{body:"Normal notification"});
      sent++;
      addHistory("Normal notification");
    } catch {}
    updateCounters(); updateProtection();
  }

  function fakeHacked(){
    if (Notification.permission !== "granted") {
      alert("Allow notifications first"); return;
    }
    stopAll();
    done = attempts = sent = 0;
    bar.style.width = "0%";
    statusText.textContent = "Sending‚Ä¶";
    log("Fake hacked demo started");

    for(let i=1;i<=total;i++){
      const t=setTimeout(()=>{
        attempts++; done++;
        const msg=messages[Math.floor(Math.random()*messages.length)];
        try {
          new Notification("SECURITY ALERT (DEMO)",{body:msg});
          sent++;
        } catch {}
        bar.style.width = (done/total*100)+"%";
        statusText.textContent = done===total ? "Completed" : "Sending‚Ä¶";
        updateCounters(); updateProtection();
        addHistory("SECURITY ALERT: "+msg);
      }, i*200);
      timeouts.push(t);
    }
  }

  function stopAll(){
    while(timeouts.length) clearTimeout(timeouts.pop());
    statusText.textContent = "Stopped";
    log("Stopped");
  }
</script>

</body>
</html>
