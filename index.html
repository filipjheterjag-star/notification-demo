<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Notification Demo</title>

<style>
:root{
  --bg:#f4f6f8;--card:#fff;--text:#000;--panel:#eef2ff;
  --green:#22c55e;--yellow:#eab308;--red:#ef4444;
}
body.dark{
  --bg:#0f172a;--card:#1e293b;--text:#e5e7eb;--panel:#020617;
}
body{
  margin:0;padding:20px;font-family:Arial,sans-serif;
  background:var(--bg);color:var(--text);
}
.main{
  max-width:560px;margin:auto;background:var(--card);
  padding:20px;border-radius:10px;
  box-shadow:0 10px 25px rgba(0,0,0,.15);
}
button,input{
  width:100%;padding:10px;margin-top:10px;
  border-radius:6px;font-size:15px;
}
input{border:1px solid #9ca3af}
button{border:none;cursor:pointer}
.primary{background:#4f46e5;color:#fff}
.normal{background:#10b981;color:#fff}
.danger{background:#ef4444;color:#fff}
.stop{background:#6b7280;color:#fff}
.panelBtn{background:#0ea5e9;color:#fff}

.notice{
  margin-top:8px;padding:8px;border-radius:6px;
  background:#fde68a;color:#92400e;font-size:13px;
  text-align:center;display:none;
}

.row{margin-top:10px;font-size:14px}
.badge{padding:3px 8px;border-radius:999px;font-size:12px;color:#fff;margin-left:6px}
.green{background:var(--green)} .yellow{background:var(--yellow)} .red{background:var(--red)}

.progress{width:100%;height:14px;background:#374151;border-radius:7px;overflow:hidden;margin-top:10px}
.bar{height:100%;width:0%;background:#ef4444}

.log{margin-top:10px;padding:10px;background:var(--panel);border-radius:6px;height:120px;overflow-y:auto;font-size:13px}

.side{
  position:fixed;top:0;right:-320px;width:320px;height:100%;
  background:var(--card);padding:20px;
  box-shadow:-10px 0 25px rgba(0,0,0,.25);
  transition:right .3s ease;z-index:1000
}
.side.open{right:0}
.history{margin-top:10px;padding:10px;background:var(--panel);border-radius:6px;height:200px;overflow-y:auto;font-size:13px}

.modal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;z-index:2000}
.modalBox{background:var(--card);color:var(--text);padding:20px;max-width:420px;border-radius:10px}

.footer{margin-top:20px;text-align:center;font-size:13px;opacity:.7}

/* WINDOWS PREVIEW */
#toastArea{
  position:fixed;right:16px;bottom:16px;z-index:3000;
  display:flex;flex-direction:column;gap:10px;pointer-events:none;
}
.toast{
  width:320px;background:#111827;color:#e5e7eb;border-radius:10px;
  box-shadow:0 10px 25px rgba(0,0,0,.35);padding:12px;
  animation:slideIn .2s ease-out;
}
.toast img{width:32px;height:32px;border-radius:6px;margin-right:8px}
.toastHeader{display:flex;align-items:center;gap:8px}
@keyframes slideIn{from{transform:translateX(20px);opacity:0}to{transform:none;opacity:1}}
</style>
</head>

<body>

<div class="main">
<h2>üîî Notification Experiment</h2>

<div class="notice" id="windowsNotice">
‚ÑπÔ∏è Windows detected ‚Äî using visual notification preview (simulation)
</div>

<button class="panelBtn" onclick="toggleInfo()">‚ÑπÔ∏è What is this demo?</button>
<button class="panelBtn" onclick="openHelp()">‚ùì Why didn‚Äôt I get a notification?</button>

<div id="infoBox" style="display:none;margin-top:10px;padding:12px;background:var(--panel);border-radius:8px;font-size:14px">
Educational demo showing notification behavior and browser protection.
</div>

<button class="panelBtn" onclick="togglePanel()">‚öôÔ∏è Open Panel</button>

<button class="primary" onclick="requestPermission()">Allow Notifications</button>

<!-- CUSTOM TITLE + ICON -->
<div class="row">Notification title:</div>
<input id="titleInput" placeholder="School Demo">

<div class="row">Icon URL (optional):</div>
<input id="iconInput" placeholder="https://example.com/icon.png">

<!-- MESSAGE -->
<div class="row">Notification message:</div>
<input id="normalText" placeholder="Hello from the demo">

<!-- PRESETS -->
<div class="row">Quick presets:</div>
<button class="panelBtn" onclick="setPreset('Homework reminder')">üìò Homework reminder</button>
<button class="panelBtn" onclick="setPreset('Meeting starts soon')">‚è∞ Meeting alert</button>
<button class="panelBtn" onclick="setPreset('Security check complete')">üîê Security notice</button>

<button class="normal" onclick="normalNotification()">Normal Notification</button>

<!-- RATE LIMIT -->
<div class="row">
Speed (ms between notifications):
<strong><span id="speedLabel">200</span> ms</strong>
</div>
<input type="range" min="100" max="2000" step="100" value="200" id="speedSlider" oninput="updateSpeed()">

<div class="row">Notifications to send: <strong><span id="countLabel">30</span></strong></div>
<input type="range" min="5" max="100" value="30" id="countSlider" oninput="updateCount()">

<button class="danger" onclick="startHackedDemo()">‚ö†Ô∏è Fake ‚ÄúHacked‚Äù Demo</button>
<button class="stop" onclick="stopAll()">üõë Stop</button>

<div class="progress"><div class="bar" id="bar"></div></div>

<div class="row">Attempts: <strong id="attempts">0</strong> | Sent: <strong id="sent">0</strong></div>
<div class="row">Protection: <span class="badge yellow" id="protection">Unknown</span></div>

<div class="log" id="log">Ready.</div>
<div class="footer">¬© Copyright FilipoPencil 2026</div>
</div>

<div class="side" id="panel">
<h3>‚öôÔ∏è Controls</h3>
<button class="panelBtn" onclick="toggleDark()">üåô Toggle Dark Mode</button>
<button class="panelBtn" onclick="togglePanel()">‚ùå Close</button>
<h3 style="margin-top:20px">üïò Notification History</h3>
<div class="history" id="history">No notifications yet.</div>
</div>

<div class="modal" id="helpModal">
<div class="modalBox">
<h3>Why didn‚Äôt I get a notification?</h3>
<p style="font-size:14px">
Windows blocks notification spam at OS level.  
This demo shows a visual preview instead.
</p>
<button class="panelBtn" onclick="closeHelp()">Close</button>
</div>
</div>

<div id="toastArea"></div>

<script>
const isWindows=/Win/i.test(navigator.userAgent);
if(isWindows) windowsNotice.style.display="block";

const titleInput=document.getElementById("titleInput");
const iconInput=document.getElementById("iconInput");
const textInput=document.getElementById("normalText");

const speedSlider=document.getElementById("speedSlider");
const speedLabel=document.getElementById("speedLabel");
const countSlider=document.getElementById("countSlider");
const countLabel=document.getElementById("countLabel");

let speed=200,total=30,attempts=0,sent=0;
const bar=document.getElementById("bar");
const historyBox=document.getElementById("history");
const toastArea=document.getElementById("toastArea");
const timeouts=[];

/* LOAD SAVED */
titleInput.value=localStorage.title||"School Demo";
iconInput.value=localStorage.icon||"";
textInput.value=localStorage.text||"";

function save(){
  localStorage.title=titleInput.value;
  localStorage.icon=iconInput.value;
  localStorage.text=textInput.value;
}

function togglePanel(){panel.classList.toggle("open")}
function toggleDark(){document.body.classList.toggle("dark")}
function toggleInfo(){infoBox.style.display=infoBox.style.display==="none"?"block":"none"}
function openHelp(){helpModal.style.display="flex"}
function closeHelp(){helpModal.style.display="none"}

function updateSpeed(){speed=+speedSlider.value;speedLabel.textContent=speed}
function updateCount(){total=+countSlider.value;countLabel.textContent=total}

function addHistory(m){
  if(historyBox.textContent.includes("No"))historyBox.innerHTML="";
  historyBox.innerHTML+="‚Ä¢ "+m+"<br>";
}

function showToast(title,body,icon){
  const t=document.createElement("div");
  t.className="toast";
  t.innerHTML=`
    <div class="toastHeader">
      ${icon?`<img src="${icon}">`:""}
      <strong>${title}</strong>
    </div>
    <div>${body}</div>
    <small>Preview ‚Ä¢ Simulation</small>
  `;
  toastArea.appendChild(t);
  setTimeout(()=>t.remove(),3500);
}

function send(title,body,icon){
  sent++;
  if(isWindows){
    showToast(title,body,icon);
  }else{
    try{new Notification(title,{body,icon});}catch{}
  }
}

function setPreset(msg){
  textInput.value=msg;
  save();
}

function normalNotification(){
  save();
  attempts++;
  send(titleInput.value||"Demo",textInput.value||"Notification",iconInput.value);
  addHistory(textInput.value);
}

function startHackedDemo(){
  stopAll();attempts=sent=0;bar.style.width="0%";
  for(let i=1;i<=total;i++){
    const t=setTimeout(()=>{
      attempts++;
      send("SECURITY ALERT",textInput.value||"Alert",iconInput.value);
      bar.style.width=(i/total*100)+"%";
      addHistory("SECURITY ALERT");
    },i*speed);
    timeouts.push(t);
  }
}

function stopAll(){while(timeouts.length)clearTimeout(timeouts.pop());}

updateSpeed();updateCount();
</script>

</body>
</html>
